Easy: 1, 3, 6. Medium: 1, 2 Hard: 1,2,3,4,5

# Setup

```{r, include=FALSE}
library(rethinking)
set.seed(100)
```

```{r}

normalize <- function(values) {
  values / sum(values)
}

p_grid <- seq(from = 0, to = 1, length.out = 1000)
prior <- rep(1, 1000)
likelihood <- dbinom(6, size = 9, prob = p_grid)
posterior <- likelihood * prior
posterior <- posterior / sum(posterior)
plot(p_grid, posterior)

samples <- sample(p_grid, prob = posterior, size = 1e4, replace = TRUE)
```

# 3E1

How much posterior prob likes below p=0.2?

```{r}
sum(samples < 0.2) / length(samples)
```

# 3E3

How much posterior prob lies between p=0.2 and p=0.8?

```{r}
sum(samples > 0.2 & samples < 0.8) / length(samples)
```

# 3E6

Which values of p contain the narrowest interval equal to 66% of the posterior probability?

```{r}
HPDI(samples, prob = 0.66)
```

# Medium

# 3M1

Suppose 8 waters in 15 tosses. Construct the posterior distribution, using grid approximation. Use a flat prior.

```{r}
p_grid <- seq(0, 1, length.out = 1000)
prior <- rep(1, 1000)
likelihood <- dbinom(8, size = 15, prob = p_grid)
posterior <- normalize(prior * likelihood)
plot(p_grid, posterior)
```

# 3M2

Draw 10,000 samples from the grid approximation above. Then use the samples to calculate the 90% HPDI for p. 

```{r}
# Sample from p with probabilities according to posterior distribution
samples <- sample(p_grid, prob = posterior, size = 10000, replace = TRUE)
HPDI(samples, prob = 0.90)
```

# Lingering questions

- Why doesn't the documentation for `dbinom` match the usage in the book?